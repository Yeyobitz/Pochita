{% extends 'base.html' %}
{% load static %}

{% block title %}Inventario{% endblock title %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'styles/list_inventory.css' %}">
{% endblock extra_head %}

{% block content %}
<div class="inventory-container">
    <div class="inventory-header">
        <h2>Inventario</h2>
        {% if not is_client %}
        <a href="{% url 'add_inventory' %}" class="btn-add">
            <i class="fas fa-plus"></i> Agregar Nuevo Producto
        </a>
        {% endif %}
    </div>

    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="table-container">
        <table class="inventory-table">
            <thead>
                <tr>
                    <th class="th-image">Imagen</th>
                    <th class="th-name">Nombre</th>
                    <th class="th-stock">Stock</th>
                    <th class="th-supplier">Proveedor</th>
                    <th class="th-category">Categoría</th>
                    <th class="th-price">Precio</th>
                    <th class="th-date">Fecha de Expiración</th>
                    <th class="th-description">Descripción</th>
                    {% if not is_client %}
                    <th class="th-actions">Acciones</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for item in inventory %}
                <tr class="inventory-row">
                    <td class="image-cell">
                        {% if item.image %}
                            <img src="{{ item.image.url }}" alt="{{ item.name }}" class="thumbnail">
                        {% endif %}
                    </td>
                    <td class="name-cell"><strong>{{ item.name }}</strong></td>
                    <td class="stock-cell {% if item.stock < 10 %}low-stock{% endif %}">{{ item.stock }}</td>
                    <td class="supplier-cell">{{ item.supplier }}</td>
                    <td class="category-cell"><span class="category-badge">{{ item.category }}</span></td>
                    <td class="price-cell">${{ item.price }}</td>
                    <td class="date-cell">{{ item.expiration_date }}</td>
                    <td class="description-cell">
                        <div class="description-content collapsed" id="desc-{{ item.id }}">
                            {{ item.description }}
                        </div>
                        <button class="btn-expand" onclick="toggleDescription('desc-{{ item.id }}', this)">
                            Ver más
                        </button>
                    </td>
                    {% if not is_client %}
                    <td class="actions-cell">
                        <div class="action-buttons">
                            <a href="{% url 'update_inventory' item.pk %}" class="btn-edit" title="Editar">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a href="{% url 'delete_inventory' item.pk %}" class="btn-delete" title="Eliminar">
                                <i class="fas fa-trash"></i>
                            </a>
                        </div>
                    </td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock content %}

{% block extra_scripts %}
<script src="{% static 'js/list_inventory.js' %}"></script>
{% endblock extra_scripts %}