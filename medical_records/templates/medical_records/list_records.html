{% extends 'base.html' %}
{% load static %}

{% block title %}Historial Médico{% endblock title %}

{% block heading %}Historial Médico{% endblock heading %}

{% block content %}
<h2>Registros Médicos</h2>

{% if user.groups.all.0.name == 'Veterinario' %}
    <div class="add-record-button">
        <a href="{% url 'create_medical_record' %}" class="btn btn-primary">Crear Nuevo Registro Médico</a>
    </div>
{% endif %}

<table>
    <thead>
        <tr>
            <th>Mascota</th>
            <th>Cliente</th>
            <th>Diagnóstico</th>
            <th>Tratamiento</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for record in medical_records %}
        <tr>
            <td>{{ record.pet_name }}</td>
            <td>{{ record.client.name }}</td>
            <td>{{ record.diagnosis|truncatechars:50 }}</td>
            <td>{{ record.treatment|truncatechars:50 }}</td>
            <td>
                <a href="{% url 'view_medical_record' record.pk %}">Ver Detalles</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5">No hay registros médicos disponibles.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock content %}
